apply plugin: "application"
allprojects {
	apply plugin: "java"
	apply plugin: "eclipse"
	apply plugin: "idea"
	tasks.withType(AbstractArchiveTask) {
		preserveFileTimestamps = false
		reproducibleFileOrder = true
	}
	eclipse {
		classpath {
			file {
				whenMerged {
					//Don't add DefaultPlugins to the modulepath, as these would be different automatic modules and each of them would have
					//the same package
					entries.findAll {
						(it.kind == "src" || it.kind == "lib")&&!it.toString().contains("DefaultPlugins")
					}.each {it.entryAttributes["module"] = "true"}
				}
			}
		}
	}
	repositories {
		mavenCentral()
	}
	task configureEnvironment() {
		def envVars = [:]
		envVars["SOURCE_DATE_EPOCH"]="0"
		tasks.withType(Exec) { environment << envVars }
	}
	assemble.dependsOn(configureEnvironment);
	dependencies {
		testCompile("org.junit.jupiter:junit-jupiter:5.6.0")
	}
}

tasks.withType(AbstractArchiveTask) {
	preserveFileTimestamps = false
	reproducibleFileOrder = true
}
